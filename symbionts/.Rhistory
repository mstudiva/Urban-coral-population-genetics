Color2 = as.factor(wgs_noclones_metadata$color2)
# Creating dendogram
wgs_noclones_dend = dissim_wgs_noclones %>% as.dist() %>% hclust(.,"ave") %>% as.dendrogram() # WGS
wgs_noclones_data = wgs_noclones_dend %>% dendro_data()
# Making the branches hang shorter so we can easily see clonal groups
wgs_noclones_data$segments$yend2 = wgs_noclones_data$segments$yend # WGS
for(i in 1:nrow(wgs_noclones_data$segments)) {
if (wgs_noclones_data$segments$yend2[i] == 0) {
wgs_noclones_data$segments$yend2[i] = (wgs_noclones_data$segments$y[i] - 0.01)}}
wgs_noclones_dendpoints = wgs_noclones_data$labels
wgs_noclones_dendpoints$Rgroup = Rgroup[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$Rgroup5clusters=Rgroup5clusters[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$color=Color[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$color2=Color2[order.dendrogram(wgs_noclones_dend)]
rownames(wgs_noclones_dendpoints) = wgs_noclones_dendpoints$label
# Making points at the ends of branches so sample IDs line up
point_wgs = as.vector(NA)  # WGS
for(i in 1:nrow(wgs_noclones_data$segments)) {
if (wgs_noclones_data$segments$yend[i] == 0) {
point_wgs[i] = wgs_noclones_data$segments$y[i] - 0.01
} else {
point_wgs[i] = NA}}
wgs_noclones_dendpoints$y = point_wgs[!is.na(point_wgs)]
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = Rgroup, color=Color), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
Color
wgs_noclones_dendpoints
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = Rgroup, color=color), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
wgs_noclones_dendpoints
Color = wgs_noclones_metadata$color
# Creating dendogram
wgs_noclones_dend = dissim_wgs_noclones %>% as.dist() %>% hclust(.,"ave") %>% as.dendrogram() # WGS
wgs_noclones_data = wgs_noclones_dend %>% dendro_data()
# Making the branches hang shorter so we can easily see clonal groups
wgs_noclones_data$segments$yend2 = wgs_noclones_data$segments$yend # WGS
for(i in 1:nrow(wgs_noclones_data$segments)) {
if (wgs_noclones_data$segments$yend2[i] == 0) {
wgs_noclones_data$segments$yend2[i] = (wgs_noclones_data$segments$y[i] - 0.01)}}
wgs_noclones_dendpoints = wgs_noclones_data$labels
wgs_noclones_dendpoints$Rgroup = Rgroup[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$Rgroup5clusters=Rgroup5clusters[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$color=Color[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$color2=Color2[order.dendrogram(wgs_noclones_dend)]
rownames(wgs_noclones_dendpoints) = wgs_noclones_dendpoints$label
# Making points at the ends of branches so sample IDs line up
point_wgs = as.vector(NA)  # WGS
for(i in 1:nrow(wgs_noclones_data$segments)) {
if (wgs_noclones_data$segments$yend[i] == 0) {
point_wgs[i] = wgs_noclones_data$segments$y[i] - 0.01
} else {
point_wgs[i] = NA}}
wgs_noclones_dendpoints$y = point_wgs[!is.na(point_wgs)]
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = Rgroup, color=color), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = color), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = color, color=color), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = Rgroup), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = Rgroup, color=color), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, fill = Rgroup, color=Rgroup), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup), size = 4, stroke = 0.25) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
Color2 = as.factor(wgs_noclones_metadata$color2)
Color2
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#b7e1cd", "#c9daf8", "#f9cb9c", "#fff2cc")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#f9cb9c","#c9daf8","#b7e1cd", "#fff2cc")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#d7191c","#2b83ba","#abdda4", "#fdae61")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
ggsave("wgs_noclones_dendrogram.pdf", plot = wgs_noclones_dendrogram, height = 6, width = 24, units = "in", dpi = 300) # WGS
if (!require("pacman")) install.packages("pacman")
pacman::p_load("dendextend", "ggdendro", "tidyverse")
# Reading in dissimilarity matrices
dissim_wgs_noclones <- t(as.matrix(read.csv("ofav_wgs_snp_passing_noclones_dist.csv", row.names = 1, head = T)))
# Reading in metadata
wgs_noclones_metadata = read.csv("bams_wgs_noclones_metadata.csv", header = T) # WGS
# Creating row and column names for dissimilarity matrix
dimnames(dissim_wgs_noclones) = list(wgs_noclones_metadata[,1],wgs_noclones_metadata[,1]) # WGS
wgs_noclones_hclust = hclust(as.dist(dissim_wgs_noclones),"ave")
# Coding factors for tree plotting
Rgroup = wgs_noclones_metadata$Rgroup # WGS
Rgroup5clusters = wgs_noclones_metadata$Rgroup5clusters
# Color = wgs_noclones_metadata$color
# Color2 = as.factor(wgs_noclones_metadata$color2)
# Creating dendogram
wgs_noclones_dend = dissim_wgs_noclones %>% as.dist() %>% hclust(.,"ave") %>% as.dendrogram() # WGS
wgs_noclones_data = wgs_noclones_dend %>% dendro_data()
# Making the branches hang shorter so we can easily see clonal groups
wgs_noclones_data$segments$yend2 = wgs_noclones_data$segments$yend # WGS
for(i in 1:nrow(wgs_noclones_data$segments)) {
if (wgs_noclones_data$segments$yend2[i] == 0) {
wgs_noclones_data$segments$yend2[i] = (wgs_noclones_data$segments$y[i] - 0.01)}}
wgs_noclones_dendpoints = wgs_noclones_data$labels
wgs_noclones_dendpoints$Rgroup = Rgroup[order.dendrogram(wgs_noclones_dend)]
wgs_noclones_dendpoints$Rgroup5clusters=Rgroup5clusters[order.dendrogram(wgs_noclones_dend)]
# wgs_noclones_dendpoints$color=Color[order.dendrogram(wgs_noclones_dend)]
# wgs_noclones_dendpoints$color2=Color2[order.dendrogram(wgs_noclones_dend)]
rownames(wgs_noclones_dendpoints) = wgs_noclones_dendpoints$label
# Making points at the ends of branches so sample IDs line up
point_wgs = as.vector(NA)  # WGS
for(i in 1:nrow(wgs_noclones_data$segments)) {
if (wgs_noclones_data$segments$yend[i] == 0) {
point_wgs[i] = wgs_noclones_data$segments$y[i] - 0.01
} else {
point_wgs[i] = NA}}
wgs_noclones_dendpoints$y = point_wgs[!is.na(point_wgs)]
# Plotting dendrogram based on genetic dissimilarity
wgs_noclones_dendrogram = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#d7191c","#2b83ba","#abdda4", "#fdae61")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram = wgs_noclones_dendrogram + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram
ggsave("wgs_noclones_dendrogram.pdf", plot = wgs_noclones_dendrogram, height = 6, width = 24, units = "in", dpi = 300) # WGS
wgs_noclones_dendrogram_5clusters = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup5clusters), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#d7191c","#2b83ba","#abdda4", "#fdae61")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram_5clusters = wgs_noclones_dendrogram_5clusters + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram_5clusters
wgs_noclones_dendrogram_5clusters = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup5clusters), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#abdda4","#d7191c","#2b83ba","#abdda4", "#fdae61")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram_5clusters = wgs_noclones_dendrogram_5clusters + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram_5clusters
ggsave("wgs_noclones_dendrogram_5clusters.pdf", plot = wgs_noclones_dendrogram_5clusters, height = 6, width = 24, units = "in", dpi = 300) # WGS
wgs_noclones_dendrogram_5clusters = ggplot() +  # WGS
geom_segment(data = segment(wgs_noclones_data), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = wgs_noclones_dendpoints, aes(x = x, y = y, color=Rgroup5clusters), size = 4, stroke = 0.25) +
scale_color_manual(values=c("#abdda4","#d7191c","#2b83ba","#1a9641", "#fdae61")) +
geom_text(data = wgs_noclones_dendpoints, aes(x = x, y = (y - .0065), label = label), angle = 90) +
labs(y = "Genetic distance") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
wgs_noclones_dendrogram_5clusters = wgs_noclones_dendrogram_5clusters + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
# legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "right")
wgs_noclones_dendrogram_5clusters
ggsave("wgs_noclones_dendrogram_5clusters.pdf", plot = wgs_noclones_dendrogram_5clusters, height = 6, width = 24, units = "in", dpi = 300) # WGS
setwd("~/Documents/GitHub/Urban-coral-population-genetics/symbionts")
