legend.title = element_text(color = "black", size = 12),
legend.text = element_text(color = "black", size = 12),
legend.position = "none",
# legend.position = c(0.85, 0.82),
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(size = 1),
panel.grid = element_blank()
)
swPlot
swPlotA = ggplot(data = swData, aes(x = year, y = Ne_median, ymin = Ne_12.5., ymax = Ne_87.5., color = Lineage, fill = Lineage)) +
geom_ribbon(color = NA, aes(alpha = Lineage)) +
# geom_line(size = 0.6) +
geom_line(linewidth = 1.15) +
scale_fill_manual(values = kColPal[c(1:3)]) +
scale_color_manual(values = kColPal[c(1:3)]) +
scale_alpha_manual(values = c(0.25, 0.25, 0.35)) +
scale_x_reverse(name = "KYA", limits = c(0,5.25e5), breaks = c(1e5,2e5,3e5,4e5,5e5), labels = c("100","200", "300", "400", "500")) +
scale_y_continuous(name = bquote(italic(N[e])~"(x10"^"3"*")"), limits = c(0,3e5), breaks = c(1e5,2e5,3e5), labels = c("100","200", "300"))+
coord_cartesian(xlim = c(5.25e5, 0), expand = FALSE) +
theme_bw()
swPlot = swPlotA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.key.size = unit(0.3, 'cm'),
legend.title = element_text(color = "black", size = 12),
legend.text = element_text(color = "black", size = 12),
legend.position = "none",
# legend.position = c(0.85, 0.82),
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(size = 1),
panel.grid = element_blank()
)
swPlot
swPlotA = ggplot(data = swData, aes(x = year, y = Ne_median, ymin = Ne_12.5., ymax = Ne_87.5., color = Lineage, fill = Lineage)) +
geom_ribbon(color = NA, aes(alpha = Lineage)) +
# geom_line(size = 0.6) +
geom_line(linewidth = 1.15) +
scale_fill_manual(values = kColPal[c(1:3)]) +
scale_color_manual(values = kColPal[c(1:3)]) +
scale_alpha_manual(values = c(0.25, 0.25, 0.35)) +
scale_x_reverse(name = "KYA", limits = c(0,5.25e5), breaks = c(1e5,2e5,3e5,4e5,5e5), labels = c("100","200", "300", "400", "500")) +
scale_y_continuous(name = bquote(italic(N[e])~"(x10"^"3"*")"), limits = c(0,4e5), breaks = c(1e5,2e5,3e5, 4e5), labels = c("100","200", "300","400"))+
coord_cartesian(xlim = c(5.25e5, 0), expand = FALSE) +
theme_bw()
swPlot = swPlotA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.key.size = unit(0.3, 'cm'),
legend.title = element_text(color = "black", size = 12),
legend.text = element_text(color = "black", size = 12),
legend.position = "none",
# legend.position = c(0.85, 0.82),
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(size = 1),
panel.grid = element_blank()
)
swPlot
swPlotA = ggplot(data = swData, aes(x = year, y = Ne_median, ymin = Ne_12.5., ymax = Ne_87.5., color = Lineage, fill = Lineage)) +
geom_ribbon(color = NA, aes(alpha = Lineage)) +
# geom_line(size = 0.6) +
geom_line(linewidth = 1.15) +
scale_fill_manual(values = kColPal[c(1:3)]) +
scale_color_manual(values = kColPal[c(1:3)]) +
scale_alpha_manual(values = c(0.25, 0.25, 0.35)) +
scale_x_reverse(name = "KYA", limits = c(0,5.25e5), breaks = c(1e5,2e5,3e5,4e5,5e5), labels = c("100","200", "300", "400", "500")) +
scale_y_continuous(name = bquote(italic(N[e])~"(x10"^"3"*")"), limits = c(0,3.5e5), breaks = c(1e5,2e5,3e5, 4e5), labels = c("100","200", "300","400"))+
coord_cartesian(xlim = c(5.25e5, 0), expand = FALSE) +
theme_bw()
swPlot = swPlotA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.key.size = unit(0.3, 'cm'),
legend.title = element_text(color = "black", size = 12),
legend.text = element_text(color = "black", size = 12),
legend.position = "none",
# legend.position = c(0.85, 0.82),
plot.background = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(size = 1),
panel.grid = element_blank()
)
swPlot
pop.order = c("Blue", "Orange", "Purple")
# reads in fst
fstMa1 <- read.delim("../../data/ofav/SFS/ofavKFst.out") %>% dplyr::select(-fst) %>% df_to_pw_mat(., "pop1", "pop2", "weightedFst")
fstMa1
fstMa = fstMa1
upperTriangle(fstMa, byrow = TRUE) <- lowerTriangle(fstMa)
fstMa <- fstMa[,pop.order] %>%
.[pop.order,]
fstMa[upper.tri(fstMa)] <- NA
fstMa <- as.data.frame(fstMa)
# rearrange and reformat matrix
fstMa$Pop = factor(row.names(fstMa), levels = unique(pop.order))
# melt matrix data (turn from matrix into long dataframe)
fst = melt(fstMa, id.vars = "Pop", value.name = "Fst", variable.name = "Pop2", na.rm = FALSE)
fst$Fst = round(fst$Fst, 3)
fst$site = fst$Pop
fst$site = factor(gsub("\\n.*", "", fst$site))
fst$site = factor(fst$site, levels = levels(fst$site)[c(1, 2, 3)])
fst$site2 = fst$Pop2
fst$site2 = factor(gsub("\\n.*", "", fst$site2))
fst$site2 = factor(fst$site2, levels = levels(fst$site2)[c(1, 2, 3)])
fst$Pop2 = factor(fst$Pop2, levels = levels(fst$Pop2)[c(3, 2, 1)])
fstHeatmapA = ggplot(data = fst %>% filter(Fst != 0), aes(Pop, Pop2, fill = as.numeric(as.character(Fst)))) +
geom_tile(color = "white") +
geom_segment(data = fst, aes(x = 0.475, xend = 0.25, y = Pop2, yend = Pop2, color = site2), size = 21.25) + #colored boxes for Y-axis labels
geom_segment(data = fst, aes(x = Pop, xend = Pop, y = 0.2, yend = 0.475, color = site), size = 41) + #colored boxes for X-axis labels
scale_color_manual(values = kColPal, guide = NULL) +
scale_fill_gradient(low = "white", high = "#EA526F", limit = c(0, 0.79), space = "Lab", name = expression(paste(italic("F")[ST])), na.value = NA,  guide = "colourbar") +
geom_text(data = fst %>% filter(Fst != 0), aes(Pop, Pop2, label = Fst), color = "black", size = 3.5, fontface = "bold") +
guides(fill = guide_colorbar(barwidth = 7.5, barheight = 0.75, title.position = "top", title.hjust = 0.5, direction = "horizontal", ticks.colour = "black", frame.colour = "black")) +
scale_y_discrete(position = "left", limits = rev(levels(fst$Pop2))) +
scale_x_discrete(limits = levels(fst$Pop2)[c(1:3)]) +
coord_cartesian(xlim = c(1, 4), ylim = c(1, 4), clip = "off") +
theme_minimal()
fstHeatmap = fstHeatmapA + theme(
axis.text.x = element_text(vjust = 3.5, size = 10, hjust = 0.5, color = "black"),
axis.text.y = element_text(size = 10, color = "black", angle = 90, hjust = 0.5, vjust = -1.5),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
legend.title = element_text(size = 8, color = "black"),
legend.text = element_text(size = 8, color = "black"),
legend.position = c(0.6, 0.9),
plot.background = element_blank(),
panel.background = element_blank(),
)
fstHeatmap
popData = read.csv("../../data/ofav/ofavMetaData.csv")[-c(11,14,22,32:34,54,59,72),] %>% dplyr::select("sample" = sampleID, "region" = region, "site" = site) # Reads in population data
popData$a = c(0:93)
popData$site = factor(popData$site)
popData$site = factor(popData$site, levels = levels(popData$site)[c(3, 10, 4, 2, 12, 8, 11, 9, 5, 7, 6, 1, 13)])
popData$region = factor(popData$region)
popData$region = factor(popData$region, levels = levels(popData$region)[c(2, 3, 4, 5, 1)])
# sampleData = fknmsSites[-c(66,68,164,166,209,211),] %>% group_by(site, depthZone)%>% summarise(depthZone = (first(depthZone)), depthRange = paste(min(depthM), "--", max(depthM), sep = ""), meanDepth = round(mean(depthM),1), n = n())%>% droplevels() %>% as.data.frame()
#
# sampleTab = sampleData
# colnames(sampleTab) = c("Site", "Depth zone", "Sampling \ndepth (m)", "Average \ndepth (m)", "n")
#
# sampleTab$Site
# finalTabSite = c("Upper Keys", "", "Lower Keys","", "Tortugas Bank", "", "Riley's Hump", "")
#
# sampleTab$Site = finalTabSite
#
hetAll = read.table("../../data/ofav/SFS/ofavHet")
colnames(hetAll) = c("sample", "He")
hetAll$sample <- popData$sample
ofavBreed = read.delim("../../data/ofav/SFS/ofavF.indF", header = FALSE)
ofavRelate = read.delim("../../data/ofav/SFS/ofavFiltRelate")
ofavRelate2 = ofavRelate %>% group_by(a, b) %>% dplyr::select("Rab" = rab, "theta" = theta)
ofavRelate2 = ofavRelate2 %>% left_join(popData, by = "a") %>% left_join(popData, by = c("b" = "a"), suffix = c(".a", ".b"))
ofavRelate2$regionsite.a = paste(ofavRelate2$region.a, ofavRelate2$site.a, sep = " ")
ofavRelate2$regionsite.b = paste(ofavRelate2$region.b, ofavRelate2$site.b, sep = " ")
ofavRelate2 = ofavRelate2 %>% left_join((pcangsd %>%dplyr::select(sample, cluster)) , by = c("sample.a" = "sample")) %>% left_join((pcangsd %>%dplyr::select(sample, cluster)) , by = c("sample.b" = "sample"))
ofavRelate = ofavRelate2 %>% filter(cluster.x != "Admixed",cluster.x == cluster.y) %>% rename(region = region.a, site = site.a, cluster = cluster.x)
ofavRelateMean = ofavRelate %>% group_by(region, site) %>% dplyr::summarize(N = n(), meanRab = mean(Rab), seRab = sd(Rab)/sqrt(N), meanTheta = mean(theta), seTheta = sd(theta)/sqrt(N)) %>% dplyr::select(-N)
het = left_join(popData, hetAll, by = "sample") %>% mutate("inbreed" = ofavBreed$V1) %>% left_join((pcangsd %>% dplyr::select(sample, cluster)) , by = "sample") %>% dplyr::select(-a)
hetStats = het %>% group_by(cluster) %>% summarise(N = n(), meanAll = mean(He), sdAll = sd(He), seAll = sd(He)/sqrt(N), meanInbreed = mean(inbreed), sdInbreed = sd(inbreed), seInbreed = sd(inbreed)/sqrt(N))
hetStats
leveneTest(lm(He ~ cluster, data = subset(het, subset = pcangsd$cluster!="Admixed")))
# p = 0.0004142
hetAov = welch_anova_test(He ~ cluster, data = subset(het, subset = het$cluster!="Admixed"))
# p = 0.021
hF = hetAov$statistic[[1]]
hetPH = games_howell_test(He ~ cluster, data = subset(het, subset = het$cluster!="Admixed"), conf.level = 0.95) %>% as.data.frame()
# He	Blue	Orange	0.00078199234	0.0002437016	0.00132028307	0.003	**
# He	Blue	Purple	0.00003888889	-0.0005539790	0.00063175673	0.971	ns
# He	Orange	Purple	-0.00074310345	-0.0014110593	-0.00007514763	0.028	*
hetLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.0065, 0.0065, 0.0065),  grp = c("a", "b", "a"))
lab_str <- sprintf("italic(F) == %.2f ~ ', ' ~ italic(p) == %.3f", hF, 0.021)
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
leveneTest(lm(inbreed ~ cluster, data = subset(het, subset = pcangsd$cluster!="Admixed")))
ibAov = welch_anova_test(inbreed ~ cluster, data = subset(het, subset = het$cluster!="Admixed"))
iF = ibAov$statistic[[1]]
ibPH = games_howell_test(inbreed ~ cluster, data = subset(het, subset = het$cluster!="Admixed"), conf.level = 0.95) %>% as.data.frame()
inbreedLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.8, 0.8, 0.8),  grp = c("a", "b", "c"))
lab_str <- sprintf("italic(F) == %.2f ~ ', ' ~ italic(p) < 0.001", hF)
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = -0.1,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
# scale_y_continuous(breaks=seq(0, 0.8, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
# mean depth for lineages
subset(pcangsd, subset = pcangsd$cluster!="Admixed") %>% group_by(cluster)
npgList = list(read_tsv("../../data/ofav/SFS/blue.thetas.idx.pestPG") %>% mutate(lineage = "Blue"),
read_tsv("../../data/ofav/SFS/orange.thetas.idx.pestPG") %>% mutate(lineage = "Orange"),
read_tsv("../../data/ofav/SFS/purple.thetas.idx.pestPG") %>% mutate(lineage = "Purple"))
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites) %>%
dplyr::summarize(tPps = mean(tPps))
View(piAll)
piAll = purrr::reduce(npgList, rbind)
View(piAll)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage)
View(piAll)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites)
View(piAll)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites) %>%
dplyr::summarize(tPps = mean(tPps))
View(piAll)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites) %>%
# dplyr::summarize(tPps = mean(tPps))
piAll$lineage = as.factor(piAll$lineage)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites)
piAll$lineage = as.factor(piAll$lineage)
levels(piAll$lineage)
piAll$lineage = factor(piAll$lineage, levels(piAll$lineage)[c(1, 2, 3)])
lmpi = lm(tPps~lineage, data=piAll)
summary(lmpi)
r2 = round(summary(lmpi)$r.squared, 3)
nuclDivPlot = ggplot(piAll, aes(x = lineage, y = tPps)) +
geom_smooth(se = F, color = 'black', method='lm', linewidth = 0.75) +
geom_point(aes(fill = lineage),shape = 21, size = 3) +
scale_color_manual(values = kColPal) +
scale_fill_manual(values = kColPal) +
labs(x='Lineage', y = bquote("Nucleotide diversity ("*pi*")"), shape = 'Lineage') +
annotate(geom = "text", x = 30, y = 0.0048, label = bquote(italic(R^2)~"="~.(r2)), size = 3) +
theme_bw() +
theme(axis.title.y = element_text(color = "black", size = 12),
axis.title.x = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
nuclDivPlot
nuclDivLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.8, 0.8, 0.8),  grp = c("a", "b", "c"))
summary(lmpi)
r2 = round(summary(lmpi)$r.squared, 3)
r2
F = round(summary(lmpi)$F-statistic, 2)
summary(lmpi)$
)
View(lmpi)
F = round(summary(lmpi)$fstatistic, 2)
F
F = round(summary(lmpi)$fstatistic[1], 2)
F
nuclDivLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.8, 0.8, 0.8),  grp = c("a", "b", "c"))
lab_str <- sprintf("italic(F) == %.2f ~ ', ' ~ italic(p) < 0.001", hF)
nuclDivPlot = ggplot(piAll, aes(x = lineage, y = tPps)) +
geom_smooth(se = F, color = 'black', method='lm', linewidth = 0.75) +
geom_point(aes(fill = lineage),shape = 21, size = 3) +
scale_color_manual(values = kColPal) +
scale_fill_manual(values = kColPal) +
labs(x='Lineage', y = bquote("Nucleotide diversity ("*pi*")"), shape = 'Lineage') +
annotate(geom = "text", x = 30, y = 0.0048, label = bquote(italic(R^2)~"="~.(r2)), size = 3) +
theme_bw() +
theme(axis.title.y = element_text(color = "black", size = 12),
axis.title.x = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
nuclDivPlot
nuclDivPlot = ggplot(piAll, aes(x = lineage, y = tPps)) +
geom_smooth(se = F, color = 'black', method='lm', linewidth = 0.75) +
geom_point(aes(fill = lineage),shape = 21, size = 3) +
scale_color_manual(values = kColPal) +
scale_fill_manual(values = kColPal) +
labs(x='Lineage', y = bquote("Nucleotide diversity ("*pi*")"), shape = 'Lineage') +
annotate(
geom  = "text",
x     = 1,
y     = -0.1,
label = lab_str,
parse = TRUE,
size  = 3
) +
theme_bw() +
theme(axis.title.y = element_text(color = "black", size = 12),
axis.title.x = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
nuclDivPlot
nuclDivPlot = ggplot(piAll, aes(x = lineage, y = tPps)) +
geom_smooth(se = F, color = 'black', method='lm', linewidth = 0.75) +
geom_point(aes(fill = lineage),shape = 21, size = 3) +
scale_color_manual(values = kColPal) +
scale_fill_manual(values = kColPal) +
labs(x='Lineage', y = bquote("Nucleotide diversity ("*pi*")"), shape = 'Lineage') +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
theme_bw() +
theme(axis.title.y = element_text(color = "black", size = 12),
axis.title.x = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
nuclDivPlot
nuclDivPlot = ggplot(piAll, aes(x = lineage, y = tPps)) +
geom_smooth(se = F, color = 'black', method='lm', linewidth = 0.75) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
scale_color_manual(values = kColPal) +
scale_fill_manual(values = kColPal) +
labs(x='Lineage', y = bquote("Nucleotide diversity ("*pi*")"), shape = 'Lineage') +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
theme_bw() +
theme(axis.title.y = element_text(color = "black", size = 12),
axis.title.x = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
nuclDivPlot
nuclDivPlot = ggplot(piAll, aes(x = lineage, y = tPps)) +
geom_smooth(se = F, color = 'black', method='lm', linewidth = 0.75) +
geom_point(aes(fill = lineage),shape = 21, size = 3) +
scale_color_manual(values = kColPal) +
scale_fill_manual(values = kColPal) +
labs(x='Lineage', y = bquote("Nucleotide diversity ("*pi*")"), shape = 'Lineage') +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
theme_bw() +
theme(axis.title.y = element_text(color = "black", size = 12),
axis.title.x = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
nuclDivPlot
summary(lmpi)
pcaTheme = theme(axis.title.x = element_text(color = "black", size = 10),
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
axis.line.x = element_blank(),
axis.title.y = element_text(color = "black", size = 10),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_blank(),
legend.position = "none",
legend.title = element_text(size = 8),
legend.text = element_text(size = 8),
legend.key.size = unit(5, "pt"),
panel.border = element_rect(color = "black", size = 1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
pcaPlot12SA = ggplot() +
geom_hline(yintercept = 0, color = "gray90", size = 0.25) +
geom_vline(xintercept = 0, color = "gray90", size = 0.25) +
geom_point(data = pcangsd, aes(x = PC1, y = PC2, fill = site, shape = region, color = site), stroke = 0, size = 2.5, alpha = 0.5, show.legend = FALSE) +
geom_point(data = pcangsd, aes(x = mean.x, y = mean.y, fill = site, shape = region), color = "black", size = 2.75, alpha = 1, stroke = 0.25) +
scale_shape_manual(values = c(21, 22, 23, 24, 25), name = "Region") +
scale_fill_manual(values = Pal, name = "Site") +
scale_color_manual(values = Pal, name = "Site") +
labs(x = paste0("PC 1 (", format(round(ofavPcaVar[1], 1), nsmall = 1)," %)"), y = paste0("PC 2 (", format(round(ofavPcaVar[2], 1), nsmall = 1), " %)")) +
guides(shape = guide_legend(override.aes = list(size = 2, stroke = 0.25, alpha = NA), order = 2, ncol = 1), fill = guide_legend(override.aes = list(shape = 22, size = 2, fill = Pal, alpha = NA), order = 1, ncol = 1)) +
theme_bw()
pcaPlot12S = pcaPlot12SA +
pcaTheme +
theme(legend.position = c(0.17, 0.23))
pcaPlot12S
pcaPlot12LA = ggplot() +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_point(data = pcangsd, aes(x = PC1, y = PC2, fill = cluster, shape = region), color = "black", size = 2, alpha = 1, show.legend = TRUE) +
scale_shape_manual(values = c(21, 22, 23, 24, 25), name = "region Zone") +
scale_fill_manual(values = kColPal, name = "Lineage") +
labs(x = paste0("PC 1 (", format(round(ofavPcaVar[1], 1), nsmall = 1)," %)"), y = paste0("PC 2 (", format(round(ofavPcaVar[2], 1), nsmall = 1), " %)")) +
guides(shape = "none", fill = guide_legend(override.aes = list(shape = 22, size = 2, fill = kColPal, alpha = NA), order = 1, ncol = 1))+
theme_bw()
pcaPlot12L = pcaPlot12LA +
pcaTheme +
theme(legend.position = c(0.12,0.15))
pcaPlot23LA = ggplot() +
geom_hline(yintercept = 0, color = "gray90", size = 0.5) +
geom_vline(xintercept = 0, color = "gray90", size = 0.5) +
geom_point(data = pcangsd, aes(x = PC3, y = PC2, fill = cluster, shape = region), color = "black", size = 2, alpha = 1, show.legend = TRUE) +
scale_shape_manual(values = c(21, 22, 23, 24, 25), name = "region Zone") +
scale_fill_manual(values = kColPal, name = "Lineage") +
labs(x = paste0("PC 3 (", format(round(ofavPcaVar[3], 1), nsmall = 1)," %)"), y = paste0("PC 2 (", format(round(ofavPcaVar[2], 1), nsmall = 1), " %)")) +
guides(shape = guide_legend(override.aes = list(size = 2, stroke = 0.5, alpha = NA), order = 2, ncol = 1), fill = guide_legend(override.aes = list(shape = 22, size = 2, fill = kColPal, alpha = NA), order = 1, ncol = 1, byrow = TRUE))+
theme_bw()
pcaPlot23L = pcaPlot23LA +
pcaTheme
pcaPlots = ((pcaPlot12S + theme(axis.title.y = element_text(margin = ggplot2::margin(r = -20, unit = "pt")))) | pcaPlot12L | pcaPlot23L) +
plot_annotation(tag_levels = 'A') &
theme(plot.tag = element_text(size = 18),
panel.background = element_rect(fill = "white"),
legend.spacing = unit(-5, "pt"),
legend.key = element_blank(),
legend.background = element_blank())
pcaPlots
pcaPlot12S
pcaPlot23L
pcaPlot23LA
pcaPlot12L
lineagePlots = (pcaPlot12L | hetPlotK | inbreedingPlot) / ( swPlot | fstHeatmap) +
plot_annotation(tag_levels = "A") &
theme(plot.tag = element_text(size = 14))
lineagePlots
ggsave("../../figures/ofav/SFS.png", plot = lineagePlots, height = 7, width = 12, units = "in", dpi = 300)
