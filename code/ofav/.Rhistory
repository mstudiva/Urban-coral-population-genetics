geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(geom = "text", x = 1, y =0.007, label = as.expression(bquote(italic(F) = 5.94 * "; " ~ italic(p) = 0.021)), size = 3) +
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(geom = "text", x = 1, y =0.007, label = as.expression(bquote(italic(F) = 5.94 "; " ~ italic(p) = 0.021)), size = 3) +
lab_str <- sprintf("italic(F)==%.3f*'; '*italic(p)==0.021", hF)
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0.007,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
lab_str <- sprintf("italic(F)=%.3f*'; '*italic(p)==0.021", hF)
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0.007,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
lab_str <- sprintf("italic(F) == %.2f ~ ', ' ~ italic(p) == %.3f", hF, 0.021)
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0.007,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0.007,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 0.1,
y     = 0.065,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 0.1,
y     = 0.0065,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 0.5,
y     = 0.0065,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0.0065,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
hetPlotKA = ggplot(data = het %>% filter(cluster != "Admixed"), aes(x = cluster, y = He)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 0.75, alpha = 0.5) +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(aes(fill = cluster, group = cluster), adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster, group = cluster), width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +  xlab("Lineage") +
geom_text(data = hetLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
scale_fill_discrete(type = kColPal, name = "Lineage") +
xlab("Lineage") +
ylab("Heterozygosity") +
# coord_cartesian(expand = TRUE, xlim = c(0.85, 4)) +
theme_bw()
hetPlotK = hetPlotKA + theme(
axis.title = element_text(color = "black", size = 12),
axis.text = element_text(color = "black", size = 10),
legend.position = "none",
legend.key.size = unit(0.3, 'cm'),
panel.border = element_rect(color = "black", size = 1),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
hetPlotK
leveneTest(lm(inbreed ~ cluster, data = subset(het, subset = pcangsd$cluster!="Admixed")))
ibAov = welch_anova_test(inbreed ~ cluster, data = subset(het, subset = het$cluster!="Admixed"))
iF = ibAov$statistic[[1]]
ibPH = games_howell_test(inbreed ~ cluster, data = subset(het, subset = het$cluster!="Admixed"), conf.level = 0.95) %>% as.data.frame()
ibPH
inbreedLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.38, 0.38, 0.38, 0.38),  grp = c("a", "b", "c"))
inbreedLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.38, 0.38, 0.38),  grp = c("a", "b", "c"))
ibAov
iF
ibAov
lab_str <- sprintf("italic(F) == %.2f ~ ', ' ~ italic(p) == %.3f", iF, <0.001)
lab_str <- sprintf("italic(F) == %.2f ~ ', ' ~ italic(p) < 0.001", hF)
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
# scale_y_continuous(breaks=seq(0, 0.4, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
scale_y_continuous(breaks=seq(0, 0.4, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
# scale_y_continuous(breaks=seq(0, 0.4, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
inbreedLetters = data.frame(x = factor(c("Blue", "Orange", "Purple")), y = c(0.8, 0.8, 0.8),  grp = c("a", "b", "c"))
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
# scale_y_continuous(breaks=seq(0, 0.4, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
scale_y_continuous(breaks=seq(0, 0.8, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = -0.1,
y     = 0,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
# scale_y_continuous(breaks=seq(0, 0.8, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
inbreedingPlot = ggplot(data = het %>% filter(cluster!="Admixed"), aes(x = cluster, y = inbreed)) +
geom_beeswarm(aes(fill = cluster), shape = 21, size = 2, cex = 1.5, alpha = 0.5) +
geom_violin(aes(fill = cluster), adjust = 1, linewidth = 0, color = "black", alpha = 0.35, width = 0.9, trim = F, scale = "width") +
geom_violin(adjust = 1, linewidth = 0.4, color = "black", alpha = 1, width = 0.9, trim = F, fill = NA, scale = "width") +
geom_boxplot(aes(fill = cluster),width = 0.2, color = "black", fill = "white", outlier.colour = NA, linewidth = 0.6, alpha = 0.5) +
geom_text(data = inbreedLetters, aes(x = x, y = y, label = grp), size = 4) +
annotate(
geom  = "text",
x     = 1,
y     = -0.1,
label = lab_str,
parse = TRUE,
size  = 3
) +
xlab("Lineage") +
ylab(bquote(~"Inbreeding coefficient ("*italic(F)*")")) +
scale_fill_manual(values = kColPal) +
scale_color_manual(values = kColPal) +
# scale_y_continuous(breaks=seq(0, 0.8, by = .05)) +
# coord_cartesian(expand = TRUE, xlim = c(0.78, 4)) +
theme_bw() +
theme(legend.position = "none",
axis.text = element_text(size = 10, color = "black"),
axis.title = element_text(size = 12, color = "black"),
panel.border = element_rect(color = "black", size = 1),
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
inbreedingPlot
# mean depth for lineages
subset(pcangsd, subset = pcangsd$cluster!="Admixed") %>% group_by(cluster)
npgList = list(read_tsv("../../data/ofav/SFS/blue.thetas.idx.pestPG") %>% mutate(lineage = "Blue", depth = 31.4),
read_tsv("../../data/ofav/SFS/orange.thetas.idx.pestPG") %>% mutate(lineage = "Orange", depth = 26.3),
read_tsv("../../data/ofav/SFS/purple.thetas.idx.pestPG") %>% mutate(lineage = "Purple", depth = 22.5))
# mean depth for lineages
subset(pcangsd, subset = pcangsd$cluster!="Admixed") %>% group_by(cluster)
npgList = list(read_tsv("../../data/ofav/SFS/blue.thetas.idx.pestPG") %>% mutate(lineage = "Blue"),
read_tsv("../../data/ofav/SFS/orange.thetas.idx.pestPG") %>% mutate(lineage = "Orange"),
read_tsv("../../data/ofav/SFS/purple.thetas.idx.pestPG") %>% mutate(lineage = "Purple"))
View(npgList)
piAll = purrr::reduce(npgList, rbind) %>%
group_by(lineage) %>%
mutate(tPps = tP/nSites) %>%
dplyr::summarize(tPps = mean(tPps))
piAll$lineage = as.factor(piAll$lineage)
levels(piAll$lineage)
piAll$lineage = factor(piAll$lineage, levels(piAll$lineage)[c(1, 2, 3)])
View(piAll)
lmpi = lm(tPps~lineage, data=piAll)
summary(lmpi)
