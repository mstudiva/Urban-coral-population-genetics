q <- read.table(ofav_k3_run16.Q, header=FALSE)
q <- read.table("../../data/ofav/ngsAdmix/ofavQ_sorted/ofav_k3_run16.Q", header=FALSE)
View(q)
options(scipen=999)
q <- read.table("../../data/ofav/ngsAdmix/ofavQ_sorted/ofav_k3_run16.Q", header=FALSE)
View(q)
dir.create(out_dir, showWarnings = FALSE)
for (file in q_files) {
q <- read.table(file, header=FALSE)
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
df <- cbind(popfile_sorted, q)
df_sorted <- df[order(df$site), ]   # uses your factor-based ordering
q_sorted <- df_sorted[, -(1:2)]     # drop metadata columns
out_file <- file.path("../../data/ofav/ngsAdmix/ofavQ_sorted", basename(file))
write.table(q_sorted, out_file, quote=FALSE,
row.names=FALSE, col.names=FALSE)
}
dir.create(out_dir, showWarnings = FALSE)
for (file in q_files) {
q <- read.table(file, header=FALSE, colClasses = "character")
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
df <- cbind(popfile_sorted, q)
df_sorted <- df[order(df$site), ]   # uses your factor-based ordering
q_sorted <- df_sorted[, -(1:2)]     # drop metadata columns
out_file <- file.path("../../data/ofav/ngsAdmix/ofavQ_sorted", basename(file))
write.table(q_sorted, out_file, quote=FALSE,
row.names=FALSE, col.names=FALSE)
}
# Cleanup
unlink(q_dir, recursive = TRUE) # Delete the uncompressed ofavQ directory
# Zip the ofavQ_sorted directory
out_dir <- normalizePath("../../data/ofav/ngsAdmix/ofavQ_sorted")
files_to_zip <- list.files(out_dir, full.names = TRUE)
zipfile_path <- file.path(dirname(out_dir), "ofavQ_sorted.zip")
zip(zipfile = zipfile_path, files = files_to_zip)
unlink(out_dir, recursive = TRUE) # Delete the uncompressed ofavQ_sorted directory
popfile <- read.table(file = "../../data/ofav/ngsAdmix/ofavPopfile.txt", header = FALSE, col.names=c("sample", "site"), stringsAsFactors=FALSE)
site_order <- c(
"EmeraldReef",
"RainbowReef",
"FisherIsland",
"CoralCityCamera",
"StarIsland",
"MacArthurNorth",
"SouthCanyonReef",
"PillarsReef",
"FIUBiscayneBay",
"GracelandReef",
"FTL4Reef",
"BC1Reef",
"T328Reef"
)
site_factor <- factor(popfile$site, levels = site_order)
ord <- order(site_factor)
popfile_sorted <- popfile[ord, ]
write.table(popfile_sorted, "../../data/ofav/ngsAdmix/ofavPopfile_sorted.txt",
quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
# Unzips, loops through, and reorders each .Q file based on popfile_sorted
unzip("../../data/ofav/ngsAdmix/ofavQ.zip", exdir = "../../data/ofav/ngsAdmix/")
q_dir  <- "../../data/ofav/ngsAdmix/ofavQ"              # where .Q files now live
out_dir <- "../../data/ofav/ngsAdmix/ofavQ_sorted"   # new folder for reordered files
dir.create(out_dir, showWarnings = FALSE)
q_files <- list.files(q_dir, pattern="\\.Q$|\\.qopt$", full.names=TRUE)
length(q_files) # should be 800
for (file in q_files) {
q <- read.table(file, header=FALSE, colClasses = "character")
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
q_sorted <- q[ord, ]
out_file <- file.path(out_dir, basename(file))
write.table(
q_sorted,
out_file,
quote = FALSE,
row.names = FALSE,
col.names = FALSE
)
}
# Cleanup
unlink(q_dir, recursive = TRUE) # Delete the uncompressed ofavQ directory
# Zip the ofavQ_sorted directory
out_dir <- normalizePath("../../data/ofav/ngsAdmix/ofavQ_sorted")
files_to_zip <- list.files(out_dir, full.names = TRUE)
zipfile_path <- file.path(dirname(out_dir), "ofavQ_sorted.zip")
zip(zipfile = zipfile_path, files = files_to_zip)
unlink(out_dir, recursive = TRUE) # Delete the uncompressed ofavQ_sorted directory
popfile <- read.table(file = "../../data/ofav/ngsAdmix/ofavPopfile.txt", header = FALSE, col.names=c("sample", "site"), stringsAsFactors=FALSE)
site_order <- c(
"EmeraldReef",
"RainbowReef",
"FisherIsland",
"CoralCityCamera",
"StarIsland",
"MacArthurNorth",
"SouthCanyonReef",
"PillarsReef",
"FIUBiscayneBay",
"GracelandReef",
"FTL4Reef",
"BC1Reef",
"T328Reef"
)
site_factor <- factor(popfile$site, levels = site_order)
ord <- order(site_factor)
popfile_sorted <- popfile[ord, ]
write.table(popfile_sorted, "../../data/ofav/ngsAdmix/ofavPopfile_sorted.txt",
quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
# Unzips, loops through, and reorders each .Q file based on popfile_sorted
unzip("../../data/ofav/ngsAdmix/ofavQ.zip", exdir = "../../data/ofav/ngsAdmix/")
q_dir  <- "../../data/ofav/ngsAdmix/ofavQ"              # where .Q files now live
out_dir <- "../../data/ofav/ngsAdmix/ofavQ_sorted"   # new folder for reordered files
dir.create(out_dir, showWarnings = FALSE)
q_files <- list.files(q_dir, pattern="\\.Q$|\\.qopt$", full.names=TRUE)
length(q_files) # should be 800
for (file in q_files) {
q <- read.table(file, header=FALSE, colClasses = "character")
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
q_sorted <- q[ord, ]
out_file <- file.path(out_dir, basename(file))
write.table(
q_sorted,
out_file,
quote = FALSE,
row.names = FALSE,
col.names = FALSE
)
}
# Cleanup
unlink(q_dir, recursive = TRUE) # Delete the uncompressed ofavQ directory
# Zip the ofavQ_sorted directory
out_dir_norm <- normalizePath(out_dir)
parent_dir   <- dirname(out_dir_norm)
old_wd <- getwd()
setwd(parent_dir)
zipfile_path <- file.path(parent_dir, "ofavQ_sorted.zip")
zip(zipfile = zipfile_path, files = "ofavQ_sorted")
parent_dir
out_dir_norm
parent_dir
parent_dir
# Zip the ofavQ_sorted directory
out_dir_norm <- normalizePath(out_dir)
parent_dir   <- dirname(out_dir_norm)
old_wd <- getwd()
setwd(parent_dir)
list.dirs(recursive = FALSE)
parent_dir
zipfile_path
# Zip the ofavQ_sorted directory
out_dir_norm <- normalizePath(out_dir)
parent_dir   <- dirname(out_dir_norm)
folder_name  <- basename(out_dir_norm)
old_wd <- getwd()
old_wd
setwd(parent_dir)
zip(
zipfile = file.path(parent_dir, "ofavQ_sorted.zip"),
files   = folder_name
)
popfile <- read.table(file = "../../data/ofav/ngsAdmix/ofavPopfile.txt", header = FALSE, col.names=c("sample", "site"), stringsAsFactors=FALSE)
site_order <- c(
"EmeraldReef",
"RainbowReef",
"FisherIsland",
"CoralCityCamera",
"StarIsland",
"MacArthurNorth",
"SouthCanyonReef",
"PillarsReef",
"FIUBiscayneBay",
"GracelandReef",
"FTL4Reef",
"BC1Reef",
"T328Reef"
)
site_factor <- factor(popfile$site, levels = site_order)
ord <- order(site_factor)
popfile_sorted <- popfile[ord, ]
write.table(popfile_sorted, "../../data/ofav/ngsAdmix/ofavPopfile_sorted.txt",
quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
# Unzips, loops through, and reorders each .Q file based on popfile_sorted
unzip("../../data/ofav/ngsAdmix/ofavQ.zip", exdir = "../../data/ofav/ngsAdmix/")
q_dir  <- "../../data/ofav/ngsAdmix/ofavQ"              # where .Q files now live
out_dir <- "../../data/ofav/ngsAdmix/ofavQ_sorted"   # new folder for reordered files
dir.create(out_dir, showWarnings = FALSE)
q_files <- list.files(q_dir, pattern="\\.Q$|\\.qopt$", full.names=TRUE)
length(q_files) # should be 800
for (file in q_files) {
q <- read.table(file, header=FALSE, colClasses = "character")
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
q_sorted <- q[ord, ]
out_file <- file.path(out_dir, basename(file))
write.table(
q_sorted,
out_file,
quote = FALSE,
row.names = FALSE,
col.names = FALSE
)
}
# Cleanup
unlink(q_dir, recursive = TRUE) # Delete the uncompressed ofavQ directory
# Zip the ofavQ_sorted directory
out_dir_norm <- normalizePath(out_dir)
parent_dir   <- dirname(out_dir_norm)
folder_name  <- basename(out_dir_norm)
old_wd <- getwd()
setwd(parent_dir)
zip(
zipfile = file.path(parent_dir, "ofavQ_sorted.zip"),
files   = folder_name
)
install.packages("zip")   # you only need this once
library(zip)
popfile <- read.table(file = "../../data/ofav/ngsAdmix/ofavPopfile.txt", header = FALSE, col.names=c("sample", "site"), stringsAsFactors=FALSE)
site_order <- c(
"EmeraldReef",
"RainbowReef",
"FisherIsland",
"CoralCityCamera",
"StarIsland",
"MacArthurNorth",
"SouthCanyonReef",
"PillarsReef",
"FIUBiscayneBay",
"GracelandReef",
"FTL4Reef",
"BC1Reef",
"T328Reef"
)
site_factor <- factor(popfile$site, levels = site_order)
ord <- order(site_factor)
popfile_sorted <- popfile[ord, ]
write.table(popfile_sorted, "../../data/ofav/ngsAdmix/ofavPopfile_sorted.txt",
quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
# Unzips, loops through, and reorders each .Q file based on popfile_sorted
unzip("../../data/ofav/ngsAdmix/ofavQ.zip", exdir = "../../data/ofav/ngsAdmix/")
q_dir  <- "../../data/ofav/ngsAdmix/ofavQ"              # where .Q files now live
out_dir <- "../../data/ofav/ngsAdmix/ofavQ_sorted"   # new folder for reordered files
dir.create(out_dir, showWarnings = FALSE)
q_files <- list.files(q_dir, pattern="\\.Q$|\\.qopt$", full.names=TRUE)
length(q_files) # should be 800
for (file in q_files) {
q <- read.table(file, header=FALSE, colClasses = "character")
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
q_sorted <- q[ord, ]
out_file <- file.path(out_dir, basename(file))
write.table(
q_sorted,
out_file,
quote = FALSE,
row.names = FALSE,
col.names = FALSE
)
}
# Cleanup
unlink(q_dir, recursive = TRUE) # Delete the uncompressed ofavQ directory
# Zip the ofavQ_sorted directory
out_dir_norm <- normalizePath(out_dir)
parent_dir   <- dirname(out_dir_norm)
folder_name  <- basename(out_dir_norm)
zipfile_path <- file.path(parent_dir, "ofavQ_sorted.zip")
zip::zipr_relative(
zipfile = zipfile_path,
files   = folder_name,
root    = parent_dir
)
cmd <- sprintf(
'cd "%s" && zip -r "%s" "%s"',
parent_dir,
basename(zipfile_path),
folder_name
)
cat("Running command:\n", cmd, "\n")
system(cmd)
if (file.exists(zipfile_path)) {
unlink(out_dir_norm, recursive = TRUE)
} # Delete the uncompressed ofavQ_sorted directory
setwd("~/Documents/GitHub/Urban-coral-population-genetics/code/cnat")
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
library(tidyverse)
popfile <- read.table(file = "../../data/ofav/ngsAdmix/ofavPopfile.txt", header = FALSE, col.names=c("sample", "site"), stringsAsFactors=FALSE)
site_order <- c(
"EmeraldReef",
"RainbowReef",
"BillBaggs",
"Seaquarium",
"FisherIsland",
"CoralCityCamera",
"StarIsland",
"MacArthurNorth",
"BelleIsle",
"SouthCanyonReef",
"PillarsReef",
"ArchCreek",
"FIUBiscayneBay",
"FTL4Reef",
"BC1Reef",
"PeanutIsland"
)
site_factor <- factor(popfile$site, levels = site_order)
ord <- order(site_factor)
popfile_sorted <- popfile[ord, ]
write.table(popfile_sorted, "../../data/ofav/ngsAdmix/ofavPopfile_sorted.txt",
quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
setwd("~/Documents/GitHub/Urban-coral-population-genetics/code/cnat")
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
library(tidyverse)
popfile <- read.table(file = "../../data/cnat/ngsAdmix/cnatPopfile.txt", header = FALSE, col.names=c("sample", "site"), stringsAsFactors=FALSE)
site_order <- c(
"EmeraldReef",
"RainbowReef",
"BillBaggs",
"Seaquarium",
"FisherIsland",
"CoralCityCamera",
"StarIsland",
"MacArthurNorth",
"BelleIsle",
"SouthCanyonReef",
"PillarsReef",
"ArchCreek",
"FIUBiscayneBay",
"FTL4Reef",
"BC1Reef",
"PeanutIsland"
)
site_factor <- factor(popfile$site, levels = site_order)
ord <- order(site_factor)
popfile_sorted <- popfile[ord, ]
write.table(popfile_sorted, "../../data/cnat/ngsAdmix/cnatPopfile_sorted.txt",
quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
# Unzips, loops through, and reorders each .Q file based on popfile_sorted
unzip("../../data/cnat/ngsAdmix/cnatQ.zip", exdir = "../../data/cnat/ngsAdmix/")
q_dir  <- "../../data/cnat/ngsAdmix/cnatQ"              # where .Q files now live
out_dir <- "../../data/cnat/ngsAdmix/cnatQ_sorted"   # new folder for reordered files
dir.create(out_dir, showWarnings = FALSE)
q_files <- list.files(q_dir, pattern="\\.Q$|\\.qopt$", full.names=TRUE)
length(q_files) # should be 800
for (file in q_files) {
q <- read.table(file, header=FALSE, colClasses = "character")
# must have same number of rows
stopifnot(nrow(q) == nrow(popfile_sorted))
q_sorted <- q[ord, ]
out_file <- file.path(out_dir, basename(file))
write.table(
q_sorted,
out_file,
quote = FALSE,
row.names = FALSE,
col.names = FALSE
)
}
# Cleanup
unlink(q_dir, recursive = TRUE) # Delete the uncompressed cnatQ directory
# Zip the cnatQ_sorted directory
out_dir_norm <- normalizePath(out_dir)
parent_dir   <- dirname(out_dir_norm)
folder_name  <- basename(out_dir_norm)
zipfile_path <- file.path(parent_dir, "cnatQ_sorted.zip")
cmd <- sprintf(
'cd "%s" && zip -r "%s" "%s"',
parent_dir,
basename(zipfile_path),
folder_name
)
cat("Running command:\n", cmd, "\n")
system(cmd)
if (file.exists(zipfile_path)) {
unlink(out_dir_norm, recursive = TRUE)
} # Delete the uncompressed cnatQ_sorted directory
setwd("~/Documents/GitHub/Urban-coral-population-genetics/code/cnat")
# setup rmarkdown environment first
knitr::opts_chunk$set(warning = FALSE, fig.align = 'left')
options(width = 88)
library(magrittr)
#setting working directory to the directory containing this .Rmd file
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
if (!require("pacman")) install.packages("pacman")
pacman::p_load_gh("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis", "ropensci/rnaturalearthhires", "KarstensLab/microshades")
pacman::p_load("cowplot", "car", "ggrepel", "ggspatial", "paletteer", "patchwork", "rgdal", "rnaturalearth", "sf", "Hmisc", "MCMC.OTU", "pairwiseAdonis", "RColorBrewer", "Redmonder", "flextable", "lubridate", "officer", "adegenet", "dendextend", "gdata", "ggdendro", "hierfstat", "kableExtra", "poppr", "reshape2", "StAMPP", "vcfR", "vegan", "boa", "magick", "rgeos", "sdmpredictors", "ggcorrplot", "tidyverse", "TeachingDemos", "LaplacesDemon", "adespatial", "ggnewscale", "ggbeeswarm", "multcomp", "rstatix", "R.utils", "graph4lg")
options("scipen" = 10)
pacman::p_load("dendextend", "ggdendro", "tidyverse")
cloneBams = read.csv("../../data/cnat/cnatMetadata.csv") # list of bam files
cloneMa = as.matrix(read.table("../../data/cnat/ANGSD/clones/cnatClones.ibsMat")) # reads in IBS matrix produced by ANGSD
dimnames(cloneMa) = list(cloneBams[,2],cloneBams[,2])
clonesHc = hclust(as.dist(cloneMa),"ave")
clonePops = cloneBams$region
cloneSite = cloneBams$site
cloneDend = cloneMa %>% as.dist() %>% hclust(.,"ave") %>% as.dendrogram()
cloneDData = cloneDend %>% dendro_data()
# Making the branches hang shorter so we can easily see clonal groups
cloneDData$segments$yend2 = cloneDData$segments$yend
for(i in 1:nrow(cloneDData$segments)) {
if (cloneDData$segments$yend2[i] == 0) {
cloneDData$segments$yend2[i] = (cloneDData$segments$y[i] - 0.01)}}
cloneDendPoints = cloneDData$labels
cloneDendPoints$region = clonePops[order.dendrogram(cloneDend)]
cloneDendPoints$site=cloneSite[order.dendrogram(cloneDend)]
rownames(cloneDendPoints) = cloneDendPoints$label
cloneDendPoints$region = as.factor(cloneDendPoints$region)
cloneDendPoints$site = as.factor(cloneDendPoints$site)
# Making points at the leaves to place symbols for regions
point = as.vector(NA)
for(i in 1:nrow(cloneDData$segments)) {
if (cloneDData$segments$yend[i] == 0) {
point[i] = cloneDData$segments$y[i] - 0.01
} else {
point[i] = NA}}
cloneDendPoints$y = point[!is.na(point)]
techReps = c("urban_052", "urban_052_2", "urban_052_3", "urban_085", "urban_085_2", "urban_119", "urban_119_2", "urban_119_3", "urban_268", "urban_268_2", "urban_268_3")
cloneDendPoints$site = factor(cloneDendPoints$site,levels(cloneDendPoints$site)[c(6, 13, 4, 14, 7, 5, 16, 10, 3, 15, 12, 1, 8 , 9, 2 ,11)])
cloneDendPoints$site
cloneDendPoints$region = factor(cloneDendPoints$region,levels(cloneDendPoints$region)[c(2, 3, 4, 5, 1, 6)])
cloneDendPoints$region
Pal <- c("#E69F00","#009E73","#F0E442","#0072B2","#D55E00","#CC79A7","#E41A1C","#377EB8","#984EA3","#FF7F00","#A65628","#F781BF","#FC8D62","#E78AC3","#A6D854","#B3B3B3")
cloneDendA = ggplot() +
geom_segment(data = segment(cloneDData), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = cloneDendPoints, aes(x = x, y = y, fill = site, shape = region), size = 4, stroke = 0.25) +
scale_fill_manual(values = Pal, name= "Site")+
scale_shape_manual(values = c(21, 22, 23, 24, 25, 8), name = "Region")+
geom_hline(yintercept = 0.11, color = "red", lty = 5, size = 0.75) + # creating a dashed line to indicate a clonal distance threshold
geom_text(data = subset(cloneDendPoints, subset = label %in% techReps), aes(x = x, y = (y - .045), label = label), angle = 90) + # spacing technical replicates further from leaf
geom_text(data = subset(cloneDendPoints, subset = !label %in% techReps), aes(x = x, y = (y - .025), label = label), angle = 90) +
labs(y = "Genetic distance (1 - IBS)") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
cloneDend = cloneDendA + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "white", colour = NA),
plot.background  = element_rect(fill = "white", colour = NA),
legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "bottom")
cloneDend
ggsave("../../figures/cnat/cloneDend.pdf", plot = cloneDend, height = 8, width = 24, units = "in", dpi = 300)
ggsave("../../figures/cnat/cloneDend.png", plot = cloneDend, height = 8, width = 24, units = "in", dpi = 300)
pacman::p_load("dendextend", "ggdendro", "tidyverse")
bams = read.csv("../../data/cnat/cnatMetadata.csv")[-c(8, 13, 16, 17, 20, 23, 25, 26, 27, 28, 29, 31, 57, 72, 79, 80, 97, 116, 123, 133),] # list of bams files and their populations (tech reps removed)
ma = as.matrix(read.table("../../data/cnat/ANGSD/cnatNoClones.ibsMat")) # reads in IBS matrix produced by ANGSD
dimnames(ma) = list(bams[,2],bams[,2])
Hc = hclust(as.dist(ma),"ave")
Pops = bams$region
Site = bams$site
Dend = ma %>% as.dist() %>% hclust(.,"ave") %>% as.dendrogram()
DData = Dend %>% dendro_data()
# Making the branches hang shorter so we can easily see clonal groups
DData$segments$yend2 = DData$segments$yend
for(i in 1:nrow(DData$segments)) {
if (DData$segments$yend2[i] == 0) {
DData$segments$yend2[i] = (DData$segments$y[i] - 0.01)}}
DendPoints = DData$labels
DendPoints$region = Pops[order.dendrogram(Dend)]
DendPoints$site=Site[order.dendrogram(Dend)]
rownames(DendPoints) = DendPoints$label
DendPoints$region = as.factor(DendPoints$region)
DendPoints$site = as.factor(DendPoints$site)
# Making points at the leaves to place symbols for regions
point = as.vector(NA)
for(i in 1:nrow(DData$segments)) {
if (DData$segments$yend[i] == 0) {
point[i] = DData$segments$y[i] - 0.01
} else {
point[i] = NA}}
DendPoints$y = point[!is.na(point)]
DendPoints$site = factor(DendPoints$site,levels(DendPoints$site)[c(6, 13, 4, 14, 7, 5, 16, 10, 3, 15, 12, 1, 8 , 9, 2 ,11)])
DendPoints$region = factor(DendPoints$region,levels(DendPoints$region)[c(2, 3, 4, 5, 1, 6)])
Pal <- c("#E69F00","#009E73","#F0E442","#0072B2","#D55E00","#CC79A7","#E41A1C","#377EB8","#984EA3","#FF7F00","#A65628","#F781BF","#FC8D62","#E78AC3","#A6D854","#B3B3B3")
DendA = ggplot() +
geom_segment(data = segment(DData), aes(x = x, y = y, xend = xend, yend = yend2), size = 0.5) +
geom_point(data = DendPoints, aes(x = x, y = y, fill = site, shape = region), size = 4, stroke = 0.25) +
# scale_fill_brewer(palette = "Dark2", name = "Site") +
scale_fill_manual(values = Pal, name= "Site")+
scale_shape_manual(values = c(21, 22, 23, 24, 25, 8), name = "Region")+
labs(y = "Genetic distance (1 - IBS)") +
guides(fill = guide_legend(override.aes = list(shape = 22)))+
theme_classic()
Dend = DendA + theme(
axis.title.x = element_blank(),
axis.text.x = element_blank(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12, color = "black", angle = 90),
axis.text.y = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.ticks.y = element_line(),
panel.grid = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = "white", colour = NA),
plot.background  = element_rect(fill = "white", colour = NA),
legend.key = element_blank(),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
legend.position = "bottom")
Dend
ggsave("../../figures/cnat/Dend.pdf", plot = Dend, height = 8, width = 24, units = "in", dpi = 300)
ggsave("../../figures/cnat/Dend.png", plot = Dend, height = 8, width = 24, units = "in", dpi = 300)
